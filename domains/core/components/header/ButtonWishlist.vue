<script lang="ts" setup>
import { SfButton, SfBadge } from "@storefront-ui/vue";

import {
  Heart,
  X as XIcon,
  Trash2Icon,
  HeartOff as HeartOffIcon,
} from "lucide-vue-next";

const { toggleWishlistSideBar } = useWishlistUiState();
const { loadWishlist, wishlistTotalItems } = useWishlist();

const handleOpenWishListSidebar = async () => {
  toggleWishlistSideBar();
  await loadWishlist();
};

onMounted(async () => {
  await loadWishlist();
});
</script>
<template>
  <SfButton
    class="group relative text-white hover:text-white active:text-white hover:bg-black-800 active:bg-black-900 mr-1 -ml-0.5 rounded-md"
    type="button" variant="tertiary" square @click="handleOpenWishListSidebar">
    <template #prefix>
      <Heart :class="[
        'h-6 w-6 transition-all duration-300',
        isOpen
          ? 'text-rose-500 fill-rose-500'
          : 'text-gray-700 dark:text-gray-300',
      ]" />
      <SfBadge :content="wishlistTotalItems"
        class="outline outline-primary-700 bg-white !text-neutral-900 group-hover:outline-primary-800 group-active:outline-primary-900 flex justify-center"
        data-testid="wishlist-badge" />
    </template>
  </SfButton>
</template>
